<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>A05 2021 Security Misconfiguration.ar - OWASP Top 10:2021</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">OWASP Top 10:2021</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../0x00-notice/" class="nav-link">Notice (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_Introduction/" class="nav-link">Introduction (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="nav-link">How to use the OWASP Top 10 as a standard (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="nav-link">How to start an AppSec program with the OWASP Top 10 (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00-about-owasp/" class="nav-link">About OWASP (en - English)</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Top 10:2021 List <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../A01_2021-Broken_Access_Control/" class="dropdown-item">A01 Broken Access Control (en - English)</a>
</li>
                                    
<li>
    <a href="../A02_2021-Cryptographic_Failures/" class="dropdown-item">A02 Cryptographic Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A03_2021-Injection/" class="dropdown-item">A03 Injection (en - English)</a>
</li>
                                    
<li>
    <a href="../A04_2021-Insecure_Design/" class="dropdown-item">A04 Insecure Design (en - English)</a>
</li>
                                    
<li>
    <a href="../A05_2021-Security_Misconfiguration/" class="dropdown-item">A05 Security Misconfiguration (en - English)</a>
</li>
                                    
<li>
    <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="dropdown-item">A06 Vulnerable and Outdated Components (en - English)</a>
</li>
                                    
<li>
    <a href="../A07_2021-Identification_and_Authentication_Failures/" class="dropdown-item">A07 Identification and Authentication Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="dropdown-item">A08 Software and Data Integrity Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="dropdown-item">A09 Security Logging and Monitoring Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A10_2021-Server-Side_Request_Forgery_%28SSRF%29/" class="dropdown-item">A10 Server Side Request Forgery (SSRF) (en - English)</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../A11_2021-Next_Steps/" class="nav-link">Next Steps (en - English)</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a href="https://github.com/OWASP/Top10/edit/master/docs/A05_2021-Security_Misconfiguration.ar.md" class="nav-link">Edit on OWASP/Top10
                                    </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#a052021" class="nav-link">A05:2021 –  الإعدادات الأمنية الخاطئة</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#_1" class="nav-link">العوامل</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_2" class="nav-link">نظرة عامة</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_3" class="nav-link">الوصف</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_4" class="nav-link">كيفية الحماية منها</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_5" class="nav-link">أمثلة على سيناريوهات الهجوم</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#_6" class="nav-link">المصادر</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cwes" class="nav-link">قائمة الربط مع إطار CWEs</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<ul>
<li class="i18n-link i18n-link-found i18n-link-en"><a href="../A05_2021-Security_Misconfiguration/">en - English</a></li>
<li class="i18n-link i18n-link-found i18n-link-es"><a href="../A05_2021-Security_Misconfiguration.es/">es - Español</a></li>
<li class="i18n-link i18n-link-found i18n-link-fr"><a href="../A05_2021-Security_Misconfiguration.fr/">fr - Français</a></li>
<li class="i18n-link i18n-link-found i18n-link-id"><a href="../A05_2021-Security_Misconfiguration.id/">id - Indonesian</a></li>
<li class="i18n-link i18n-link-found i18n-link-it"><a href="../A05_2021-Security_Misconfiguration.it/">it - Italiano</a></li>
<li class="i18n-link i18n-link-found i18n-link-ja"><a href="../A05_2021-Security_Misconfiguration.ja/">ja - 日本語</a></li>
<li class="i18n-link i18n-link-found i18n-link-pt_BR"><a href="../A05_2021-Security_Misconfiguration.pt_BR/">pt_BR - Português (Brasil)</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_CN"><a href="../A05_2021-Security_Misconfiguration.zh_CN/">zh_CN - 简体中文</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_TW"><a href="../A05_2021-Security_Misconfiguration.zh_TW/">zh_TW - 繁體中文</a></li>
</ul>
<h1 id="a052021">A05:2021 –  الإعدادات الأمنية الخاطئة</h1>
<h2 id="_1">العوامل</h2>
<table>
<thead>
<tr>
<th>ربطها مع CWEs</th>
<th>الحد الأقصى للحدوث</th>
<th>متوسط معدل الحدوث</th>
<th>التغطية القصوى</th>
<th>متوسط معدل التغطية</th>
<th>متوسط استغلال الثغرات</th>
<th>متوسط التأثير</th>
<th>إجمالي التكرار</th>
<th>إجمالي نقاط الضعف CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td>20</td>
<td>19.84%</td>
<td>4.51%</td>
<td>89.58%</td>
<td>44.84%</td>
<td>8.12</td>
<td>6.56</td>
<td>208,387</td>
<td>789</td>
</tr>
</tbody>
</table>
<h2 id="_2">نظرة عامة</h2>
<p>بعد أن كان هذا التهديد   في المرتبة السادسة في الإصدار السابق لعام 2017 الآن نجده في المرتبة الخامسة، حيث أنه تم إجراء اختبار على %90 من البرامج والتطبيقات للتأكد إن كانت تحتوي على أيّة أخطاء في طريقة الإعدادات والتكوين الصحيحة، فليس من المُستغرب انتقال هذا التهديد من المرتبة السادسة إلى الخامسة. كذلك تم ضم "XML External Entities XXE" لهذا النوع من الإعدادات والتكوين الخاطئة. تضمن الـ CWEs التالية CWE-16 (Configuration), CWE-611 (Improper Restriction of XML External Entity).</p>
<h2 id="_3">الوصف</h2>
<p>من المحتمل ان يكون التطبيق ضعيف امنياً إذا احتوى على النقاط التالية:</p>
<ul>
<li>
<p>عدم مراجعة التكوين والضبط الآمن لإعدادات التطبيق أو في أي جزء من أجزاء التطبيق أو تكوين أذونات خاطئة في الخدمات السحابيّة.</p>
</li>
<li>
<p>تثبيت وإتاحة خدمات ومِيزات غير ضرورية (منافذ غير ضرورية، الخدمات، الصفحات، الحسابات، والصلاحيات).</p>
</li>
<li>
<p>تفعيل الحسابات الافتراضية أو عدم تغييرها أو عدم تغيير كلمات المرور الخاصة بها.</p>
</li>
<li>
<p>كشف رسائل معالجة الأخطاء (Error Handling) عن معلومات قابلة للتتبّع (Stack Traces) أو عرض رسائل الخطأ التي تحتوي على معلومات تفصيلية يمكن أن تُستغل من قِبل المستخدم.</p>
</li>
<li>
<p>تكون الميزات الأمنية الأحدث مُعطّلة أو لم يتم تكوينها بشكل آمن في الأنظمة التي تمت ترقيتها. </p>
</li>
<li>
<p>عدم تعيين إعدادات الأمان في خوادم التطبيقات وإطار التطبيقات على سبيل المثال (Struts, Spring, ASP.NET) والمكتبات وقواعد البيانات وما إلى ذلك إلى قيم آمنة.</p>
</li>
<li>
<p>لا يرسل أو يستخدم الخادم عناوين "Headers" عند نقل البيانات الحساسة للمتصفح أو عند تقديمها من قِبل المتصفح.</p>
</li>
<li>
<p>لم يعد البرنامج مدعومًا من قبل مزوّدي الخدمات أو ضعيف أمنيًا لاحتوائه على ثغرات أمنية (انظر إلى - A06:2021 الثغرات والأنظمة الغير قابلة للتحديث).</p>
</li>
</ul>
<p>من دون امتلاك إجراءات مفهومة وقابلة للتكّرار للإعدادات الأمنية لتكوين البرنامج بما يتوافق مع الضوابط الأمنية، تُصبح الأنظمة في خطر عالي.</p>
<h2 id="_4">كيفية الحماية منها</h2>
<p>يجب تطبيق آلية آمنة لتكوين البرامج أو الأجهزة، تشمل على:</p>
<ul>
<li>
<p>تكرار عملية مراجعة التكوين الآمن، والذي سيؤدي إلى تسريع وتسهيل   مهمة إنشاء بيئة جديدة مكوّنة بشكل آمن. كما يجب أن يتم تكوين بيئات التطوير وضمان جودة وبيئة الإنتاج بشكل يتطابق مع استخدام كلمات مرور مختلفة في كل بيئة. أيضًا يجب أن تكون هذه العملية آلية للتقليل من الجهد المتطلّب عند إعداد بيئة جديدة وآمنة.</p>
</li>
<li>
<p>الاكتفاء بالحد الأدنى الأساسي من النظام أو المنصّة بدون تفعيل مِيزات، أو مكونات، أو وثائق، أو عيّنات غير ضرورية، مع حذف وإبطال الميزات وإطار الغير مستخدمة أو عدم تثبيتها.</p>
</li>
<li>
<p>مراجعة وتحديث الإعدادات بما يتناسب مع كافة ملاحظات الأمان والتحديثات والإصلاحات كجزء من عملية إدارة حِزم الإصلاحات والترقيات. (انظر إلى- A06:2021 الثغرات والأنظمة الغير قابلة للتحديثات). بالإضافة إلى مراجعة أذونات التخزين السحابيّة على سبيل المثال (S3 Bucket Permissions).</p>
</li>
<li>
<p>تتيح بنية التطبيق المقسّمة فصلًا فعّالًا وآمنًا بين المكونات، مع التجزئة في مجموعات أمان السحابة (ACLs).</p>
</li>
<li>
<p>إرسال توجيهات الأمان إلى المستخدمين على سبيل المثال Security Headers.</p>
</li>
<li>
<p>أتمتة عملية التحقق من التحديثات الآمنة للتحقّق من فعاليّة التكوينات والإعدادات في جميع البيئات.</p>
</li>
<li>
<p>تشغيل أدوات الفحص للتحقّق من فعاليّة التكوينات والإعدادات في جميع البيئات للكشف عن الإعدادات الخاطئة.</p>
</li>
</ul>
<h2 id="_5">أمثلة على سيناريوهات الهجوم</h2>
<p><strong>سيناريو #1:</strong> عندما يحتوي احد الخوادم على تطبيق من التطبيقات غير محدث وما يزال يُستخدم    في بيئة الإنتاج "Production Server" هذه العيّنات من التطبيقات قد تحتوي على ثغرات أمنية يمكن أن يستخدمها المهاجم في اختراق الخادم ، وبافتراض أن أحد هذه البرامج هي وحدة تحكّم لإدارة الخادم وتحتوي على الاعدادات الافتراضية والرقم السري الافتراضي، في هذه الحالة فإن المهاجم سوف يُسجّل الدخول باستخدام الرقم السري الافتراضي ويتحكّم بالخادم.</p>
<p><strong>سيناريو #2:</strong> عندما تكون قائمة الدليل "Directory Listing" غير معطّلة في الخادم الخاص بك، قد يكتشف المهاجم أن بإمكانه سرد قائمة الملفات المخزنة على الخادم وبعد ذلك بإمكانه العثور وتثبيت جميع فئات جافا (Compiled Java Classes) ومن ثم يقوم بفكّها وتطبيق الهندسة العكسية لعرض الشّفرة المصدرية، سوف يحاول المهاجم بعد ذلك إيجاد خطأ أمني للتحكّم في الوصول إلى الخادم.</p>
<p><strong>سيناريو #3:</strong> عندما تقوم إعدادات خادم التطبيق بإرجاع رسائل خاطئة تفصيليّة، على سبيل المثال Stack Traces إلى المستخدم، ومن المُحتمل أن يؤدي هذا إلى الكشف عن معلومات حساسة أو ثغرات أمنية أخرى أو معلومات مثل إصدارات المكونات المعروفة بأنها قابلة للاستغلال.  </p>
<p><strong>سيناريو #4:</strong> أن يكون مقدّم الخدمة السحابيّة لديه أذونات مشاركة افتراضية مفتوحة على الإنترنت من قِبل مستخدمي CSP الآخرين، يسمح هذا بالوصول إلى البيانات الحساسة المخزّنة في سحابة التخزين.</p>
<h2 id="_6">المصادر</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/02-Configuration_and_Deployment_Management_Testing/README">OWASP Testing Guide: Configuration Management</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/stable/4-Web_Application_Security_Testing/08-Testing_for_Error_Handling/01-Testing_For_Improper_Error_Handling">OWASP Testing Guide: Testing for Error Codes</a></p>
</li>
<li>
<p>Application Security Verification Standard V19 Configuration</p>
</li>
<li>
<p><a href="https://csrc.nist.gov/publications/detail/sp/800-123/final">NIST Guide to General Server Hardening</a></p>
</li>
<li>
<p><a href="https://www.cisecurity.org/cis-benchmarks/">CIS Security Configuration Guides/Benchmarks</a></p>
</li>
<li>
<p><a href="https://blog.websecurify.com/2017/10/aws-s3-bucket-discovery.html">Amazon S3 Bucket Discovery and Enumeration</a></p>
</li>
</ul>
<h2 id="cwes">قائمة الربط مع إطار CWEs</h2>
<p><a href="https://cwe.mitre.org/data/definitions/2.html">CWE-2 7PK - Environment</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/11.html">CWE-11 ASP.NET Misconfiguration: Creating Debug Binary</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/13.html">CWE-13 ASP.NET Misconfiguration: Password in Configuration File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/15.html">CWE-15 External Control of System or Configuration Setting</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/16.html">CWE-16 Configuration</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/260.html">CWE-260 Password in Configuration File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/315.html">CWE-315 Cleartext Storage of Sensitive Information in a Cookie</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/520.html">CWE-520 .NET Misconfiguration: Use of Impersonation</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/526.html">CWE-526 Exposure of Sensitive Information Through Environmental Variables</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/537.html">CWE-537 Java Runtime Error Message Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/541.html">CWE-541 Inclusion of Sensitive Information in an Include File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/547.html">CWE-547 Use of Hard-coded, Security-relevant Constants</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/611.html">CWE-611 Improper Restriction of XML External Entity Reference</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/614.html">CWE-614 Sensitive Cookie in HTTPS Session Without 'Secure' Attribute</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/756.html">CWE-756 Missing Custom Error Page</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/776.html">CWE-776 Improper Restriction of Recursive Entity References in DTDs ('XML Entity Expansion')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/942.html">CWE-942 Permissive Cross-domain Policy with Untrusted Domains</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1004.html">CWE-1004 Sensitive Cookie Without 'HttpOnly' Flag</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1032.html">CWE-1032 OWASP Top Ten 2017 Category A6 - Security Misconfiguration</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1174.html">CWE-1174 ASP.NET Misconfiguration: Improper Model Validation</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>© Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
