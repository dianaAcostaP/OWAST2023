<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>A01 2021 Broken Access Control.id - OWASP Top 10:2021</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">OWASP Top 10:2021</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../0x00-notice/" class="nav-link">Notice (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_Introduction/" class="nav-link">Introduction (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="nav-link">How to use the OWASP Top 10 as a standard (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="nav-link">How to start an AppSec program with the OWASP Top 10 (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00-about-owasp/" class="nav-link">About OWASP (en - English)</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Top 10:2021 List <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../A01_2021-Broken_Access_Control/" class="dropdown-item">A01 Broken Access Control (en - English)</a>
</li>
                                    
<li>
    <a href="../A02_2021-Cryptographic_Failures/" class="dropdown-item">A02 Cryptographic Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A03_2021-Injection/" class="dropdown-item">A03 Injection (en - English)</a>
</li>
                                    
<li>
    <a href="../A04_2021-Insecure_Design/" class="dropdown-item">A04 Insecure Design (en - English)</a>
</li>
                                    
<li>
    <a href="../A05_2021-Security_Misconfiguration/" class="dropdown-item">A05 Security Misconfiguration (en - English)</a>
</li>
                                    
<li>
    <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="dropdown-item">A06 Vulnerable and Outdated Components (en - English)</a>
</li>
                                    
<li>
    <a href="../A07_2021-Identification_and_Authentication_Failures/" class="dropdown-item">A07 Identification and Authentication Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="dropdown-item">A08 Software and Data Integrity Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="dropdown-item">A09 Security Logging and Monitoring Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A10_2021-Server-Side_Request_Forgery_%28SSRF%29/" class="dropdown-item">A10 Server Side Request Forgery (SSRF) (en - English)</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../A11_2021-Next_Steps/" class="nav-link">Next Steps (en - English)</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a href="https://github.com/OWASP/Top10/edit/master/docs/A01_2021-Broken_Access_Control.id.md" class="nav-link">Edit on OWASP/Top10
                                    </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#a012021-kerusakan-akses-kontrol" class="nav-link">A01:2021 – Kerusakan Akses Kontrol</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#faktor-faktor" class="nav-link">Faktor-Faktor</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#gambaran" class="nav-link">Gambaran</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#deskripsi" class="nav-link">Deskripsi</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#cara-mencegah" class="nav-link">Cara Mencegah</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#contoh-skenario-penyerangan" class="nav-link">Contoh Skenario Penyerangan</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#referensi" class="nav-link">Referensi</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#daftar-klasifikasi-cwe" class="nav-link">Daftar Klasifikasi CWE</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<ul>
<li class="i18n-link i18n-link-found i18n-link-en"><a href="../A01_2021-Broken_Access_Control/">en - English</a></li>
<li class="i18n-link i18n-link-found i18n-link-ar"><a href="../A01_2021-Broken_Access_Control.ar/">ar - العربية</a></li>
<li class="i18n-link i18n-link-found i18n-link-es"><a href="../A01_2021-Broken_Access_Control.es/">es - Español</a></li>
<li class="i18n-link i18n-link-found i18n-link-fr"><a href="../A01_2021-Broken_Access_Control.fr/">fr - Français</a></li>
<li class="i18n-link i18n-link-found i18n-link-it"><a href="../A01_2021-Broken_Access_Control.it/">it - Italiano</a></li>
<li class="i18n-link i18n-link-found i18n-link-ja"><a href="../A01_2021-Broken_Access_Control.ja/">ja - 日本語</a></li>
<li class="i18n-link i18n-link-found i18n-link-pt_BR"><a href="../A01_2021-Broken_Access_Control.pt_BR/">pt_BR - Português (Brasil)</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_CN"><a href="../A01_2021-Broken_Access_Control.zh_CN/">zh_CN - 简体中文</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_TW"><a href="../A01_2021-Broken_Access_Control.zh_TW/">zh_TW - 繁體中文</a></li>
</ul>
<h1 id="a012021-kerusakan-akses-kontrol">A01:2021 – Kerusakan Akses Kontrol</h1>
<h2 id="faktor-faktor">Faktor-Faktor</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">Klasifikasi CWE</th>
<th style="text-align: center;">Tingkat Kejadian Maksimum</th>
<th style="text-align: center;">Rata - Rata Tingkat kejadian</th>
<th style="text-align: center;">Cakupan Maksimum</th>
<th style="text-align: center;">Rata - Rata Cakupan</th>
<th style="text-align: center;">Rata-rata Bobot Eksploitasi</th>
<th style="text-align: center;">Rata - Rata Bobot Dampak</th>
<th style="text-align: center;">Total Kejadian</th>
<th style="text-align: center;">Total CVEs</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">34</td>
<td style="text-align: center;">55.97%</td>
<td style="text-align: center;">3.81%</td>
<td style="text-align: center;">94.55%</td>
<td style="text-align: center;">47.72%</td>
<td style="text-align: center;">6.92</td>
<td style="text-align: center;">5.93</td>
<td style="text-align: center;">318,487</td>
<td style="text-align: center;">19,013</td>
</tr>
</tbody>
</table>
<h2 id="gambaran">Gambaran</h2>
<p>Bergerak ke atas dari posisi ke 5, 94% aplikasi di tes untuk untuk berbagai jenis dari broken access control. CWE (Common Weakness Enumeration) atau kelemahan enumerasi umum yang perlu diperhatikan termasuk dari <em>CWE-200: Exposure of Sensitive Information to an Unauthorized Actor</em>, <em>CWE-201: Exposure of Sensitive Information Through Sent Data</em>, and <em>CWE-352: Cross-Site Request Forgery</em>.</p>
<h2 id="deskripsi">Deskripsi</h2>
<p>Akses Kontrol menetapkan sebuah peraturan yang dimana user tidak dapat melakukan sebuah aksi diluar permission yang diberikan. Kegagalan atas hal ini dapat mengakibatkan pengeluaran informasi yang tidak diizinkan, modifikasi, atau penghancuran dari semua data atau pemberlakuan sebuah fungsi bisnis di luar limit sebuah user. Kelemahan Akses Kontrol termasuk dari :</p>
<p>Melewati pengecekan akses kontrol dengan memodifikasi URL, internal application state, atau HTML page, atau menggunakan custom API attack tool.</p>
<p>Membolehkan primary key untuk dapat diganti ke record user lain, membolehkan penglihatan atau perubahan akun orang lain.</p>
<p>Penaikan sebuah privilege (Elevation Privilege). Yang dimana sebuah orang dapat dianggap sebagai user tanpa melakukan logged in dan yang dimana sebuah user dapat dianggap sebagai admin tanpa melakukan logged in.</p>
<p>Manipulasi metadata, seperti memanipulasi dengan JSON Web Token (JWT) akses kontrol token, atau memanipulasi cookie atau hidden field untuk menaikan privilege (elevation privilege) atau menyalahgunakan penggunaan dari JWT invalidation.</p>
<p>Konfigurasi yang salah pada CORS sehingga menyebabkan API akses yang tidak diizinkan.</p>
<p>Force browsing untuk mengakses authenticated pages sebagai unauthenticated user atau mengakses privileged pages sebagai user standard. Mengakses API yang tidak memiliki akses kontrol untuk POST, PUT, dan DELETE.</p>
<h2 id="cara-mencegah">Cara Mencegah</h2>
<p>Akses Kontrol hanya efektif pada kode server-side yang dapat dipercaya dan server-less API, yang dimana penyerang tidak dapat memodifikasi pengecek akses kontrol atau meta datanya.</p>
<ul>
<li>
<p>Menolak semua akses kecuali ke public resource.</p>
</li>
<li>
<p>Melakukan implementasi mekanisme akses kontrol sekali dan digunakan kembali pada seluruh aplikasi sehingga meminimalisir penggunaan CORS.</p>
</li>
<li>
<p>Agar user tidak dapat melakukan create, read, update, atau mendelete record secara bebas, model akses kontrol seharusnya membatasi hal tersebut dengan menggunakan ownership untuk tiap record.</p>
</li>
<li>
<p>Batas yang diperlukan oleh bisnis yang unik pada aplikasi seharusnya dilakukan oleh domain models.</p>
</li>
<li>
<p>Nonaktifkan direktori listing web server dan pastikan file metadata (contohnya .git) dan file backup tidak ada di dalam web roots.</p>
</li>
<li>
<p>Catat kegagalan akses kontrol dan alert admin jika diperlukan (seperti adanya kegagalan yang terjadi berulang - ulang).</p>
</li>
<li>
<p>Ukur batasan dari API dan akses ke kontroler untuk meminimalisir kerusakan dari automated attack tooling.</p>
</li>
<li>
<p>JWT tokens harus langsung di hilangkan validasinya pada server setelah logout.</p>
</li>
</ul>
<p>Developers and QA staff should include functional access control unit
and integration tests.</p>
<h2 id="contoh-skenario-penyerangan">Contoh Skenario Penyerangan</h2>
<p><strong>Skenario #1:</strong> Aplikasi menggunakan data yang belum diverifikasi pada sebuah pemanggilan SQL yang mengakses informasi akun</p>
<blockquote>
<p>pstmt.setString(1, request.getParameter("acct"));</p>
<p>ResultSet results = pstmt.executeQuery( );</p>
</blockquote>
<p>Penyerang hanya perlu untuk memodifikasi parameter ‘acct’ pada browser untuk mengirim nomer akun mana yang diinginkan. Jika parameter tersebut tidak diverifikasi secara benar, maka penyerang dapat mengakses akun user manapun.</p>
<p>https://example.com/app/accountInfo?acct=notmyacct</p>
<p><strong>Skenario #2:</strong> Penyerang dapat memaksa untuk melakukan penjelajahan ke target URLs. Halaman Admin memerlukan hak admin untuk dapat diakses.</p>
<blockquote>
<p>https://example.com/app/getappInfo</p>
<p>https://example.com/app/admin_getappInfo</p>
</blockquote>
<p>Jika sebuah user yang belum di autentikasi dapat mengakses kedua page tersebut maka itu merupakan suatu kelemahan. Jika user yang non-admin dapat mengakses halaman admin, maka merupakan suatu kelemahan.</p>
<h2 id="referensi">Referensi</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c7-enforce-access-controls">OWASP Proactive Controls: Enforce Access
  Controls</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V4 Access
  Control</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/README">OWASP Testing Guide: Authorization
  Testing</a></p>
</li>
<li>
<p><a href="https://portswigger.net/blog/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">PortSwigger: Exploiting CORS
  misconfiguration</a></p>
</li>
</ul>
<h2 id="daftar-klasifikasi-cwe">Daftar Klasifikasi CWE</h2>
<p>CWE-22 Improper Limitation of a Pathname to a Restricted Directory
('Path Traversal')</p>
<p>CWE-23 Relative Path Traversal</p>
<p>CWE-35 Path Traversal: '.../...//'</p>
<p>CWE-59 Improper Link Resolution Before File Access ('Link Following')</p>
<p>CWE-200 Exposure of Sensitive Information to an Unauthorized Actor</p>
<p>CWE-201 Exposure of Sensitive Information Through Sent Data</p>
<p>CWE-219 Storage of File with Sensitive Data Under Web Root</p>
<p>CWE-264 Permissions, Privileges, and Access Controls (should no longer
be used)</p>
<p>CWE-275 Permission Issues</p>
<p>CWE-276 Incorrect Default Permissions</p>
<p>CWE-284 Improper Access Control</p>
<p>CWE-285 Improper Authorization</p>
<p>CWE-352 Cross-Site Request Forgery (CSRF)</p>
<p>CWE-359 Exposure of Private Personal Information to an Unauthorized
Actor</p>
<p>CWE-377 Insecure Temporary File</p>
<p>CWE-402 Transmission of Private Resources into a New Sphere ('Resource
Leak')</p>
<p>CWE-425 Direct Request ('Forced Browsing')</p>
<p>CWE-441 Unintended Proxy or Intermediary ('Confused Deputy')</p>
<p>CWE-497 Exposure of Sensitive System Information to an Unauthorized
Control Sphere</p>
<p>CWE-538 Insertion of Sensitive Information into Externally-Accessible
File or Directory</p>
<p>CWE-540 Inclusion of Sensitive Information in Source Code</p>
<p>CWE-548 Exposure of Information Through Directory Listing</p>
<p>CWE-552 Files or Directories Accessible to External Parties</p>
<p>CWE-566 Authorization Bypass Through User-Controlled SQL Primary Key</p>
<p>CWE-601 URL Redirection to Untrusted Site ('Open Redirect')</p>
<p>CWE-639 Authorization Bypass Through User-Controlled Key</p>
<p>CWE-651 Exposure of WSDL File Containing Sensitive Information</p>
<p>CWE-668 Exposure of Resource to Wrong Sphere</p>
<p>CWE-706 Use of Incorrectly-Resolved Name or Reference</p>
<p>CWE-862 Missing Authorization</p>
<p>CWE-863 Incorrect Authorization</p>
<p>CWE-913 Improper Control of Dynamically-Managed Code Resources</p>
<p>CWE-922 Insecure Storage of Sensitive Information</p>
<p>CWE-1275 Sensitive Cookie with Improper SameSite Attribute</p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>© Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
