<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        
        
        <link rel="shortcut icon" href="../img/favicon.ico">
        <title>A01 2021 Broken Access Control.it - OWASP Top 10:2021</title>
        <link href="../css/bootstrap.min.css" rel="stylesheet">
        <link href="../css/font-awesome.min.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script>hljs.highlightAll();</script> 
    </head>

    <body>
        <div class="navbar fixed-top navbar-expand-lg navbar-dark bg-primary">
            <div class="container">
                <a class="navbar-brand" href="..">OWASP Top 10:2021</a>
                <!-- Expander button -->
                <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbar-collapse">
                    <span class="navbar-toggler-icon"></span>
                </button>

                <!-- Expanded navigation -->
                <div id="navbar-collapse" class="navbar-collapse collapse">
                        <!-- Main navigation -->
                        <ul class="nav navbar-nav">
                            <li class="navitem">
                                <a href=".." class="nav-link">Home (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../0x00-notice/" class="nav-link">Notice (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_Introduction/" class="nav-link">Introduction (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021_How_to_use_the_OWASP_Top_10_as_a_standard/" class="nav-link">How to use the OWASP Top 10 as a standard (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00_2021-How_to_start_an_AppSec_program_with_the_OWASP_Top_10/" class="nav-link">How to start an AppSec program with the OWASP Top 10 (en - English)</a>
                            </li>
                            <li class="navitem">
                                <a href="../A00-about-owasp/" class="nav-link">About OWASP (en - English)</a>
                            </li>
                            <li class="dropdown">
                                <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">Top 10:2021 List <b class="caret"></b></a>
                                <ul class="dropdown-menu">
                                    
<li>
    <a href="../A01_2021-Broken_Access_Control/" class="dropdown-item">A01 Broken Access Control (en - English)</a>
</li>
                                    
<li>
    <a href="../A02_2021-Cryptographic_Failures/" class="dropdown-item">A02 Cryptographic Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A03_2021-Injection/" class="dropdown-item">A03 Injection (en - English)</a>
</li>
                                    
<li>
    <a href="../A04_2021-Insecure_Design/" class="dropdown-item">A04 Insecure Design (en - English)</a>
</li>
                                    
<li>
    <a href="../A05_2021-Security_Misconfiguration/" class="dropdown-item">A05 Security Misconfiguration (en - English)</a>
</li>
                                    
<li>
    <a href="../A06_2021-Vulnerable_and_Outdated_Components/" class="dropdown-item">A06 Vulnerable and Outdated Components (en - English)</a>
</li>
                                    
<li>
    <a href="../A07_2021-Identification_and_Authentication_Failures/" class="dropdown-item">A07 Identification and Authentication Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A08_2021-Software_and_Data_Integrity_Failures/" class="dropdown-item">A08 Software and Data Integrity Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A09_2021-Security_Logging_and_Monitoring_Failures/" class="dropdown-item">A09 Security Logging and Monitoring Failures (en - English)</a>
</li>
                                    
<li>
    <a href="../A10_2021-Server-Side_Request_Forgery_%28SSRF%29/" class="dropdown-item">A10 Server Side Request Forgery (SSRF) (en - English)</a>
</li>
                                </ul>
                            </li>
                            <li class="navitem">
                                <a href="../A11_2021-Next_Steps/" class="nav-link">Next Steps (en - English)</a>
                            </li>
                        </ul>

                    <ul class="nav navbar-nav ml-auto">
                            <li class="nav-item">
                                <a href="https://github.com/OWASP/Top10/edit/master/docs/A01_2021-Broken_Access_Control.it.md" class="nav-link">Edit on OWASP/Top10
                                    </a>
                            </li>
                    </ul>
                </div>
            </div>
        </div>

        <div class="container">
            <div class="row">
                    <div class="col-md-3"><div class="navbar-light navbar-expand-md bs-sidebar hidden-print affix" role="complementary">
    <div class="navbar-header">
        <button type="button" class="navbar-toggler collapsed" data-toggle="collapse" data-target="#toc-collapse" title="Table of Contents">
            <span class="fa fa-angle-down"></span>
        </button>
    </div>

    
    <div id="toc-collapse" class="navbar-collapse collapse card bg-secondary">
        <ul class="nav flex-column">
            
            <li class="nav-item" data-level="1"><a href="#a012021-broken-access-control" class="nav-link">A01:2021 – Broken Access Control</a>
              <ul class="nav flex-column">
            <li class="nav-item" data-level="2"><a href="#fattori" class="nav-link">Fattori</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#panoramica" class="nav-link">Panoramica</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#descrizione" class="nav-link">Descrizione</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#come-prevenirla" class="nav-link">Come prevenirla</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#esempi-di-scenari-dattacco" class="nav-link">Esempi di scenari d'attacco</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#riferimenti" class="nav-link">Riferimenti</a>
              <ul class="nav flex-column">
              </ul>
            </li>
            <li class="nav-item" data-level="2"><a href="#lista-dei-cwes-correlati" class="nav-link">Lista dei CWEs correlati</a>
              <ul class="nav flex-column">
              </ul>
            </li>
              </ul>
            </li>
        </ul>
    </div>
</div></div>
                    <div class="col-md-9" role="main">

<ul>
<li class="i18n-link i18n-link-found i18n-link-en"><a href="../A01_2021-Broken_Access_Control/">en - English</a></li>
<li class="i18n-link i18n-link-found i18n-link-ar"><a href="../A01_2021-Broken_Access_Control.ar/">ar - العربية</a></li>
<li class="i18n-link i18n-link-found i18n-link-es"><a href="../A01_2021-Broken_Access_Control.es/">es - Español</a></li>
<li class="i18n-link i18n-link-found i18n-link-fr"><a href="../A01_2021-Broken_Access_Control.fr/">fr - Français</a></li>
<li class="i18n-link i18n-link-found i18n-link-id"><a href="../A01_2021-Broken_Access_Control.id/">id - Indonesian</a></li>
<li class="i18n-link i18n-link-found i18n-link-ja"><a href="../A01_2021-Broken_Access_Control.ja/">ja - 日本語</a></li>
<li class="i18n-link i18n-link-found i18n-link-pt_BR"><a href="../A01_2021-Broken_Access_Control.pt_BR/">pt_BR - Português (Brasil)</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_CN"><a href="../A01_2021-Broken_Access_Control.zh_CN/">zh_CN - 简体中文</a></li>
<li class="i18n-link i18n-link-found i18n-link-zh_TW"><a href="../A01_2021-Broken_Access_Control.zh_TW/">zh_TW - 繁體中文</a></li>
</ul>
<h1 id="a012021-broken-access-control">A01:2021 – Broken Access Control    <img align="right" alt="icon" src="../assets/TOP_10_Icons_Final_Broken_Access_Control.png" style="height:80px;width:80px" /></h1>
<h2 id="fattori">Fattori</h2>
<table>
<thead>
<tr>
<th style="text-align: center;">CWEs corrispondenti</th>
<th style="text-align: center;">Tasso di incidenza Max</th>
<th style="text-align: center;">Tasso di incidenza Medio</th>
<th style="text-align: center;">Sfruttabilità pesata</th>
<th style="text-align: center;">Impatto Medio</th>
<th style="text-align: center;">Copertura Max</th>
<th style="text-align: center;">Copertura media</th>
<th style="text-align: center;">Occorrenze Totali</th>
<th style="text-align: center;">CVE Totali</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;">34</td>
<td style="text-align: center;">55.97%</td>
<td style="text-align: center;">3.81%</td>
<td style="text-align: center;">6.92</td>
<td style="text-align: center;">5.93</td>
<td style="text-align: center;">94.55%</td>
<td style="text-align: center;">47.72%</td>
<td style="text-align: center;">318,487</td>
<td style="text-align: center;">19,013</td>
</tr>
</tbody>
</table>
<h2 id="panoramica">Panoramica</h2>
<p>Salendo dalla quinta posizione, il 94% delle applicazioni è stato testato per
una qualche forma di broken access control con un tasso medio di incidenza del 3,81%, e ha il maggior numero di occorrenze nel dataset con oltre 318k. Le Common Weakness Enumerations (CWE) incluse sono <em>CWE-200: Exposure of Sensitive Information to an Unauthorized Actor</em>, <em>CWE-201: Exposure of Sensitive Information Through Sent Data</em>, e <em>CWE-352: Cross-Site Request Forgery</em>.</p>
<h2 id="descrizione">Descrizione</h2>
<p>Il controllo degli accessi fa rispettare la policy in modo che gli utenti non possano agire al di fuori dei
permessi previsti. Problematiche su questo tipo di controllo tipicamente portano alla divulgazione non autorizzata di
informazioni, alla modifica o alla distruzione di tutti i dati o l'esecuzione di una funzione di business al di fuori dei limiti dell'utente. Le vulnerabilità più comuni che affliggono i meccanismi di controllo degli accessi includono:</p>
<ul>
<li>
<p>Violazione del principio del minimo privilegio o deny by default,
  dove l'accesso dovrebbe essere concesso solo per particolari capabilities,
  ruoli o utenti, ma è disponibile a chiunque.</p>
</li>
<li>
<p>Bypassare i controlli di accesso modificando l'URL (modifica dei parametri o
  navigazione forzata), lo stato interno dell'applicazione o la
  pagina HTML, o utilizzando uno strumento di attacco che modifica le richieste API.</p>
</li>
<li>
<p>Permettere la visualizzazione o la modifica dell'account di qualcun altro, fornendo
  il suo identificatore unico (insecure direct object references)</p>
</li>
<li>
<p>Accesso all'API con controlli di accesso mancanti per POST, PUT e DELETE.</p>
</li>
<li>
<p>Elevazione dei privilegi. Agire come un utente senza essere loggato o
  agire come amministratore quando si è svolto il login come utente base.</p>
</li>
<li>
<p>Manipolazione dei metadati, come la riproduzione o la modifica di un JSON
  Web Token (JWT), o un cookie o un campo nascosto
  manipolati per elevare i privilegi o abusare dell'invalidazione del JWT.</p>
</li>
<li>
<p>La configurazione errata di CORS permette l'accesso all'API da origini non autorizzate/non fidate.</p>
</li>
<li>
<p>Forzare la navigazione verso pagine autenticate come utente non autenticato o
  a pagine privilegiate come utente base.</p>
</li>
</ul>
<h2 id="come-prevenirla">Come prevenirla</h2>
<p>Il controllo degli accessi è efficace solo nel codice lato server o
API server-less, dove l'attaccante non può modificare i meccanismi di controllo dell'accesso
o i metadati.</p>
<ul>
<li>
<p>Tranne che per le risorse pubbliche, applicare il principio di deny by default.</p>
</li>
<li>
<p>Implementare i meccanismi di controllo dell'accesso una volta sola e riutilizzarli in tutta
  l'applicazione, incluso limitare l'utilizzo di Cross-Origin Resource Sharing (CORS).</p>
</li>
<li>
<p>I controlli di accesso del Model dovrebbero imporre la proprietà dei record piuttosto che
  accettare che l'utente possa creare, leggere, aggiornare o cancellare qualsiasi
  record.</p>
</li>
<li>
<p>I requisiti unici dei vincoli di business di un'applicazione dovrebbero essere applicati nei
  modelli di dominio.</p>
</li>
<li>
<p>Disabilitare il directory listing del server web e garantire che i metadati dei file (ad es,
  .git) e i file di backup non siano presenti all'interno delle web roots.</p>
</li>
<li>
<p>Registrare i fallimenti dei meccanismi di controllo dell'accesso, avvisare gli amministratori quando appropriato (ad es,
  fallimenti ripetuti).</p>
</li>
<li>
<p>Implementare meccanismi di rate limiting per accesso all'API e al controller per minimizzare il danno da
  strumenti di attacco automatizzati.</p>
</li>
<li>
<p>Gli identificatori di sessione stateful dovrebbero essere invalidati sul server dopo il logout.
  I token JWT stateless dovrebbero piuttosto essere di breve durata in modo che la finestra di 
  opportunità per un attaccante sia ridotta al minimo. Per i JWT di lunga durata è altamente raccomandato di
  seguire gli standard OAuth per revocare l'accesso.</p>
</li>
</ul>
<p>Gli sviluppatori e lo staff di QA dovrebbero includere test funzionali di controllo dell'accesso
e test di integrazione.</p>
<h2 id="esempi-di-scenari-dattacco">Esempi di scenari d'attacco</h2>
<p><strong>Scenario #1:</strong> L'applicazione usa dati non verificati in una chiamata SQL che
sta accedendo alle informazioni dell'account:</p>
<pre><code> pstmt.setString(1, request.getParameter(&quot;acct&quot;));
 ResultSet results = pstmt.executeQuery( );
</code></pre>
<p>Un attaccante modifica semplicemente il parametro 'acct' del browser per inviare
numero di conto a piacere. Se il parametro non è verificato correttamente, l'attaccante può accedere all'account di qualsiasi utente.</p>
<pre><code> https://example.com/app/accountInfo?acct=notmyacct
</code></pre>
<p><strong>Scenario #2:</strong> Un attaccante forza semplicemente la navigazione verso gli URL di destinazione. Sono richiesti i diritti di amministratore per accedere alla pagina di amministrazione.</p>
<pre><code> https://example.com/app/getappInfo
 https://example.com/app/admin_getappInfo
</code></pre>
<p>Se un utente non autenticato può accedere a una delle due pagine, è una falla. Se un non amministratore può accedere alla pagina dell'amministratore, questa è una falla.</p>
<h2 id="riferimenti">Riferimenti</h2>
<ul>
<li>
<p><a href="https://owasp.org/www-project-proactive-controls/v3/en/c7-enforce-access-controls">OWASP Proactive Controls: Enforce Access
    Controls</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-application-security-verification-standard">OWASP Application Security Verification Standard: V4 Access
    Control</a></p>
</li>
<li>
<p><a href="https://owasp.org/www-project-web-security-testing-guide/latest/4-Web_Application_Security_Testing/05-Authorization_Testing/README">OWASP Testing Guide: Authorization
    Testing</a></p>
</li>
<li>
<p><a href="https://cheatsheetseries.owasp.org/cheatsheets/Authorization_Cheat_Sheet.html">OWASP Cheat Sheet: Authorization</a></p>
</li>
<li>
<p><a href="https://portswigger.net/blog/exploiting-cors-misconfigurations-for-bitcoins-and-bounties">PortSwigger: Exploiting CORS
    misconfiguration</a></p>
</li>
<li>
<p><a href="https://www.oauth.com/oauth2-servers/listing-authorizations/revoking-access/">OAuth: Revoking Access</a></p>
</li>
</ul>
<h2 id="lista-dei-cwes-correlati">Lista dei CWEs correlati</h2>
<p><a href="https://cwe.mitre.org/data/definitions/22.html">CWE-22 Improper Limitation of a Pathname to a Restricted Directory
('Path Traversal')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/23.html">CWE-23 Relative Path Traversal</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/35.html">CWE-35 Path Traversal: '.../...//'</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/59.html">CWE-59 Improper Link Resolution Before File Access ('Link Following')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/200.html">CWE-200 Exposure of Sensitive Information to an Unauthorized Actor</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/201.html">CWE-201 Exposure of Sensitive Information Through Sent Data</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/219.html">CWE-219 Storage of File with Sensitive Data Under Web Root</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/264.html">CWE-264 Permissions, Privileges, and Access Controls (should no longer be used)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/275.html">CWE-275 Permission Issues</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/276.html">CWE-276 Incorrect Default Permissions</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/284.html">CWE-284 Improper Access Control</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/285.html">CWE-285 Improper Authorization</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/352.html">CWE-352 Cross-Site Request Forgery (CSRF)</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/359.html">CWE-359 Exposure of Private Personal Information to an Unauthorized Actor</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/377.html">CWE-377 Insecure Temporary File</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/402.html">CWE-402 Transmission of Private Resources into a New Sphere ('Resource Leak')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/425.html">CWE-425 Direct Request ('Forced Browsing')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/441.html">CWE-441 Unintended Proxy or Intermediary ('Confused Deputy')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/497.html">CWE-497 Exposure of Sensitive System Information to an Unauthorized Control Sphere</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/538.html">CWE-538 Insertion of Sensitive Information into Externally-Accessible File or Directory</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/540.html">CWE-540 Inclusion of Sensitive Information in Source Code</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/548.html">CWE-548 Exposure of Information Through Directory Listing</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/552.html">CWE-552 Files or Directories Accessible to External Parties</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/566.html">CWE-566 Authorization Bypass Through User-Controlled SQL Primary Key</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/601.html">CWE-601 URL Redirection to Untrusted Site ('Open Redirect')</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/639.html">CWE-639 Authorization Bypass Through User-Controlled Key</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/651.html">CWE-651 Exposure of WSDL File Containing Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/668.html">CWE-668 Exposure of Resource to Wrong Sphere</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/706.html">CWE-706 Use of Incorrectly-Resolved Name or Reference</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/862.html">CWE-862 Missing Authorization</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/863.html">CWE-863 Incorrect Authorization</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/913.html">CWE-913 Improper Control of Dynamically-Managed Code Resources</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/922.html">CWE-922 Insecure Storage of Sensitive Information</a></p>
<p><a href="https://cwe.mitre.org/data/definitions/1275.html">CWE-1275 Sensitive Cookie with Improper SameSite Attribute</a></p></div>
            </div>
        </div>

        <footer class="col-md-12">
            <hr>
                <p>© Copyright 2021 - OWASP Top 10 team - This work is licensed under a <a rel="license" href="http://creativecommons.org/licenses/by/3.0/deed.en_US">Creative Commons Attribution 3.0 Unported License</a>.</p>
            <p>Documentation built with <a href="https://www.mkdocs.org/">MkDocs</a>.</p>
        </footer>
        <script src="../js/jquery-3.6.0.min.js"></script>
        <script src="../js/bootstrap.min.js"></script>
        <script>
            var base_url = "..",
                shortcuts = {"help": 191, "next": 78, "previous": 80, "search": 83};
        </script>
        <script src="../js/base.js"></script>

        <div class="modal" id="mkdocs_keyboard_modal" tabindex="-1" role="dialog" aria-labelledby="keyboardModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h4 class="modal-title" id="keyboardModalLabel">Keyboard Shortcuts</h4>
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
            </div>
            <div class="modal-body">
              <table class="table">
                <thead>
                  <tr>
                    <th style="width: 20%;">Keys</th>
                    <th>Action</th>
                  </tr>
                </thead>
                <tbody>
                  <tr>
                    <td class="help shortcut"><kbd>?</kbd></td>
                    <td>Open this help</td>
                  </tr>
                  <tr>
                    <td class="next shortcut"><kbd>n</kbd></td>
                    <td>Next page</td>
                  </tr>
                  <tr>
                    <td class="prev shortcut"><kbd>p</kbd></td>
                    <td>Previous page</td>
                  </tr>
                  <tr>
                    <td class="search shortcut"><kbd>s</kbd></td>
                    <td>Search</td>
                  </tr>
                </tbody>
              </table>
            </div>
            <div class="modal-footer">
            </div>
        </div>
    </div>
</div>

    </body>
</html>
